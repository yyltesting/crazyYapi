<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="UTF-8"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><link rel="apple-touch-icon" sizes="180x180" href="..\ydoc\images\apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="..\ydoc\images\favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="..\ydoc\images\favicon-16x16.png"/><link rel="manifest" href="..\ydoc\images\manifest.json"/><link rel="mask-icon" href="..\ydoc\images\safari-pinned-tab.svg" color="#5bbad5"/><meta name="theme-color" content="#ffffff"/><meta http-equiv="Cache-Control" content="no-transform"/><meta http-equiv="Cache-Control" content="no-siteapp"/><title>项目操作-教程</title><link rel="stylesheet" href="..\ydoc\styles\style.css"/><meta name="author" content="testeryyl"/><meta name="keywords" content="api管理,接口管理,接口文档,api文档"/><meta name="description" content="YApi 是高效、易用、功能强大的 api 管理平台，旨在为开发、产品、测试人员提供更优雅的接口管理服务。可以帮助开发者轻松创建、发布、维护 API，YApi 还为用户提供了优秀的交互体验，开发人员只需利用平台提供的接口数据写入工具以及简单的点击操作就可以实现接口的管理"/><meta id="releativePath" content=".."/><link rel="stylesheet" href="..\ydoc\ydoc-plugin-search\search.css"/><link rel="stylesheet" href="..\ydoc\ydoc-plugin-search\search.css"/><link rel="stylesheet" href="..\ydoc\ydoc-plugin-img-view\imgView.css"/><link rel="stylesheet" href="..\web.css"/></head><body><div class="g-doc"><div class="m-aside"><div class="m-summary" id="js-menu"><div class="m-summary-content" id="js-menu-content"><div class="m-summary-block"><div class="m-summary-title">快速上手</div><ul class="m-summary-list indent"><li class="item"><a href="index.html" class="href">认识YApi</a></li><li class="item"><a href="quickstart.html" class="href">创建第一个API</a></li></ul></div><div class="m-summary-block"><div class="m-summary-title">进阶篇</div><ul class="m-summary-list indent"><li class="item"><a href="manage.html" class="href">权限</a></li><li class="item"><div class="m-summary-block"><a href="" class="href">项目操作</a><ul class="m-summary-list indent"><li class="item"><a href="project.html#%e5%9f%ba%e6%9c%ac%e8%ae%be%e7%bd%ae" class="href">基本设置</a></li><li class="item"><a href="project.html#%e5%85%a8%e5%b1%80%e9%85%8d%e7%bd%ae" class="href">全局配置</a></li><li class="item"><a href="project.html#%e6%96%b0%e5%bb%ba%e9%a1%b9%e7%9b%ae" class="href">新建项目</a></li><li class="item"><a href="project.html#%e4%bf%ae%e6%94%b9%e9%a1%b9%e7%9b%ae" class="href">修改项目</a></li><li class="item"><a href="project.html#%e9%a1%b9%e7%9b%ae%e8%bf%81%e7%a7%bb" class="href">项目迁移</a></li><li class="item"><a href="project.html#%e9%a1%b9%e7%9b%ae%e6%8b%b7%e8%b4%9d" class="href">项目拷贝</a></li><li class="item"><a href="project.html#%e9%85%8d%e7%bd%ae%e7%8e%af%e5%a2%83" class="href">配置环境</a></li><li class="item"><a href="project.html#快捷操作-stripe支付、metamask连接" class="href">快捷操作</a></li><li class="item"><a href="project.html#%e8%af%b7%e6%b1%82%e9%85%8d%e7%bd%ae" class="href">请求配置</a></li><li class="item"><a href="project.html#token" class="href">token配置</a></li><li class="item"><a href="project.html#%e5%85%a8%e5%b1%80mock" class="href">全局mock</a></li><li class="item"><a href="project.html#%e9%a3%9e%e4%b9%a6%e6%9c%ba%e5%99%a8%e4%ba%ba%e9%80%9a%e7%9f%a5" class="href">飞书机器人通知</a></li></ul></div></li><li class="item"><div class="m-summary-block"><a href="api.html" class="href">接口操作</a><ul class="m-summary-list indent"><li class="item"><a href="api.html#%e6%8e%a5%e5%8f%a3%e9%85%8d%e7%bd%ae" class="href">接口设置</a></li><li class="item"><a href="api.html#%e6%8e%a5%e5%8f%a3-%e7%94%a8%e4%be%8b%e6%89%b9%e9%87%8f%e6%9b%b4%e6%96%b0" class="href">接口批量更新用例</a></li><li class="item"><a href="api.html#%e6%8e%a5%e5%8f%a3%e8%bf%90%e8%a1%8c" class="href">接口运行</a></li></ul></div></li><li class="item"><div class="m-summary-block"><a href="case.html" class="href">自动化测试</a><ul class="m-summary-list indent"><li class="item"><a href="case.html#%e7%ac%ac%e4%b8%80%e6%ad%a5%ef%bc%8c%e6%b5%8b%e8%af%95%e9%9b%86%e5%90%88" class="href">第一步，测试集合</a></li><li class="item"><a href="case.html#%e7%ac%ac%e4%ba%8c%e6%ad%a5%ef%bc%8c%e7%bc%96%e8%be%91%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b" class="href">第二步，编辑测试用例</a></li><li class="item"><a href="case.html#%e7%ac%ac%e4%b8%89%e6%ad%a5%ef%bc%8c%e8%bf%90%e8%a1%8c%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95" class="href">第三步，运行自动化测试</a></li><li class="item"><a href="case.html#%e6%96%ad%e8%a8%80%e8%84%9a%e6%9c%ac%e5%85%ac%e5%85%b1%e5%8f%98%e9%87%8f" class="href">断言脚本公共变量</a></li><li class="item"><a href="case.html#%e6%9c%8d%e5%8a%a1%e7%ab%af%e8%87%aa%e5%8a%a8%e5%8c%96%e6%b5%8b%e8%af%95" class="href">服务端自动化测试</a></li></ul></div></li><li class="item"><div class="m-summary-block"><a href="autotestplan.html" class="href">自动化测试计划</a><ul class="m-summary-list indent"><li class="item"><a href="autotestplan.html#%e7%ac%ac%e4%b8%80%e6%ad%a5%ef%bc%8c%e6%96%b0%e5%bb%ba%e8%ae%a1%e5%88%92" class="href">第一步，新建计划</a></li><li class="item"><a href="autotestplan.html#%e7%ac%ac%e4%ba%8c%e6%ad%a5%ef%bc%8c%e7%bc%96%e8%be%91%e6%b5%8b%e8%af%95%e8%ae%a1%e5%88%92" class="href">第二步，编辑测试计划</a></li><li class="item"><a href="autotestplan.html#%e6%9f%a5%e7%9c%8b%e6%8a%a5%e5%91%8a" class="href">第三步，查看报告</a></li><li class="item"><a href="autotestplan.html#%e6%8e%a8%e9%80%81%e6%8a%a5%e5%91%8a" class="href">推送报告</a></li></ul></div></li><li class="item"><div class="m-summary-block"><a href="caselib.html" class="href">用例库关联</a><ul class="m-summary-list indent"><li class="item"><a href="caselib.html#%e7%ac%ac%e4%b8%80%e6%ad%a5%ef%bc%8c%e6%b7%bb%e5%8a%a0%e9%9c%80%e6%b1%82" class="href">第一步，新建需求模块</a></li><li class="item"><a href="caselib.html#%e7%ac%ac%e4%ba%8c%e6%ad%a5%ef%bc%8c%e6%b7%bb%e5%8a%a0%e7%94%a8%e4%be%8b" class="href">第二步，新增/导入用例</a></li><li class="item"><a href="caselib.html#%e5%85%b3%e8%81%94case" class="href">第三步，关联case</a></li></ul></div></li><li class="item"><a href="teststats.html#%e6%b5%8b%e8%af%95%e7%bb%9f%e8%ae%a1" class="href">测试统计</a></li><li class="item"><div class="m-summary-block"><a href="mock.html" class="href">数据Mock</a><ul class="m-summary-list indent"><li class="item"><a href="mock.html#方式1.-mockjs" class="href">方式1. mockjs</a></li><li class="item"><a href="mock.html#方式2.-json-schema" class="href">方式2. json-schema</a></li><li class="item"><a href="mock.html#如何使用-mock" class="href">如何使用</a></li><li class="item"><a href="mock.html#mock%e8%af%b7%e6%b1%82%e4%b8%a5%e6%a0%bc%e6%a8%a1%e5%bc%8f" class="href">严格模式</a></li></ul></div></li><li class="item"><div class="m-summary-block"><a href="adv_mock.html" class="href">高级Mock</a><ul class="m-summary-list indent"><li class="item"><a href="adv_mock.html#mock-期望" class="href">Mock 期望</a></li><li class="item"><a href="adv_mock.html#自定义-mock-脚本" class="href">自定义脚本</a></li></ul></div></li><li class="item"><div class="m-summary-block"><a href="data.html" class="href">数据导入</a><ul class="m-summary-list indent"><li class="item"><a href="data.html#postman-数据导入" class="href">Postman 数据导入</a></li><li class="item"><a href="data.html#har-数据导入" class="href">HAR 数据导入</a></li><li class="item"><a href="data.html#swagger-数据导入" class="href">Swagger 数据导入</a></li><li class="item"><a href="data.html#yapi%e6%8e%a5%e5%8f%a3json%e6%95%b0%e6%8d%ae%e5%af%bc%e5%85%a5" class="href">JSON 数据导入</a></li><li class="item"><a href="data.html#%e9%80%9a%e8%bf%87%e5%91%bd%e4%bb%a4%e8%a1%8c%e5%af%bc%e5%85%a5%e6%8e%a5%e5%8f%a3%e6%95%b0%e6%8d%ae" class="href">通过命令行导入接口数据</a></li></ul></div></li><li class="item"><a href="export-data.html" class="href">数据导出</a></li><li class="item"><a href="chromeCORS.html" class="href">Chrome跨域</a></li></ul></div><div class="m-summary-block"><div class="m-summary-title">自定义</div><ul class="m-summary-list indent"><li class="item"><div class="m-summary-block"><a href="plugin-index.html" class="href">插件</a><ul class="m-summary-list indent"><li class="item"><a href="plugin-dev.html" class="href">插件开发</a></li><li class="item"><a href="plugin-list.html" class="href">插件列表</a></li><li class="item"><a href="plugin-hooks.html" class="href">钩子</a></li></ul></div></li><li class="item"><a href="redev.html" class="href">二次开发</a></li></ul></div><div class="m-summary-block"><ul class="m-summary-list"><li class="item"><a href="qa.html" class="href">常见问题解答</a></li><li class="item"><a href="CHANGELOG.html" class="href">版本记录</a></li></ul></div></div></div><div class="m-summary-switch" id="js-summary-switch"><svg viewBox="0 0 926.23699 573.74994" version="1.1" x="0px" y="0px" width="15" height="15" class="bottom"><g transform="translate(904.92214,-879.1482)"><path d="m -673.67664,1221.6502 -231.2455,-231.24803 55.6165,-55.627 c 30.5891,-30.59485 56.1806,-55.627 56.8701,-55.627 0.6894,0 79.8637,78.60862 175.9427,174.68583 l 174.6892,174.6858 174.6892,-174.6858 c 96.079,-96.07721 175.253196,-174.68583 175.942696,-174.68583 0.6895,0 26.281,25.03215 56.8701,55.627 l 55.6165,55.627 -231.245496,231.24803 c -127.185,127.1864-231.5279,231.248 -231.873,231.248 -0.3451,0 -104.688,-104.0616 -231.873,-231.248 z" fill="#fff"></path></g></svg><svg viewBox="0 0 926.23699 573.74994" version="1.1" x="0px" y="0px" width="15" height="15" class="top"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="aaa" fill="#fff" fill-rule="nonzero"><path d="M231.2455,342.502 L0,111.25397 L55.6165,55.62697 C86.2056,25.03212 111.7971,-2.99999998e-05 112.4866,-2.99999998e-05 C113.176,-2.99999998e-05 192.3503,78.60859 288.4293,174.6858 L463.1185,349.3716 L637.8077,174.6858 C733.8867,78.60859 813.060896,-2.99999997e-05 813.750396,-2.99999997e-05 C814.439896,-2.99999997e-05 840.031396,25.03212 870.620496,55.62697 L926.236996,111.25397 L694.9915,342.502 C567.8065,469.6884 463.4636,573.75 463.1185,573.75 C462.7734,573.75 358.4305,469.6884 231.2455,342.502 Z" id="Shape" transform="translate(463.118498, 286.874985) scale(1, -1) translate(-463.118498, -286.874985) "></path></g></g></svg></div></div><div class="m-main" id="js-panel"><header class="m-header" id="js-header"><div class="m-header-title js-logo"><a href="..\index.html" target="_self"><img class="logo" width="36" src="images\logo_header@2x.png"/><h6 class="name">YApi</h6></a></div><div><div class="m-search">
      <div class="icon">&#xf0fd;</div>
      <input type="text" class="input js-input" placeholder="搜索" />
      <div class="m-search-result js-search-result"></div>
    </div>
<div class="m-search">
      <div class="icon">&#xf0fd;</div>
      <input type="text" class="input js-input" placeholder="搜索" />
      <div class="m-search-result js-search-result"></div>
    </div></div><nav class="m-header-nav js-nav"><ul class="m-header-items"><li class="item active"><a class="href" href="index.html">教程</a></li><li class="item "><a class="href" href="..\devops\index.html">内网部署</a></li><li class="item "><a class="href" href="..\openapi.html">开放Api</a></li></ul></nav><div id="js-nav-btn" class="m-header-btn ui-font-ydoc"></div></header><div class="m-content" id="js-content"><div id="markdown-body" class="m-content-container markdown-body"><h1>项目操作</h1>
<h2 id="基本设置">基本设置</h2>
<ul>
<li>tag 信息：可自定义tag名称和tag描述，tag信息可用在接口tag标识中;</li>
<li>mock 严格模式：开启后 mock 请求会对 query，body form 的必须字段和 json schema 进行校验;</li>
<li>开启json5：开启后允许接口请求body 和返回值中写 json 字段。yapi建议用户关闭 json5， 因为json-schema 格式可以进行接口格式校验。</li>
</ul>
<img src="./images/usage/project-message.png">
<h2 id="全局配置">全局配置</h2>
<ul>
<li>此处可配置一些全局配置，目前仅支持openapi相关配置</li>
</ul>
<img src="./images/global_config.png">
<h2 id="新建项目">新建项目</h2>
<p>点击右上角的 <code>+</code> 新建项目，进入新建项目页面。</p>
<img src="./images/usage/project_add.png">
<p>在新建项目页，填写项目信息：</p>
<blockquote>
<ul>
<li>项目名称不允许重复，包括其他分组</li>
<li>基本路径为接口统一添加了前缀</li>
<li>新建项目页只列出了部分配置，其他详细配置(环境配置、项目图标等)需要进入项目页的“设置”面板进行配置。</li>
</ul>
</blockquote>
<img src="./images/usage/project_add_panel.png">
<h2 id="修改项目">修改项目</h2>
<p>在项目页点击上方的 <code>设置</code> Tab 进入项目设置面板，这个面板涵盖了项目的所有配置。</p>
<img src="./images/usage/project_setting.png">
<p>这里比新建项目页面新增的功能如下：</p>
<h3 id="修改项目-修改项目图标">修改项目图标</h3>
<p>点击项目图标，可以修改图标及背景色：</p>
<img src="./images/usage/project_setting_logo.png">
<h2 id="项目迁移">项目迁移</h2>
<p>YApi 中支持项目迁移到不同的分组中。</p>
<img src="./images/project-remove.png">
<p>迁移权限： 只有管理员和该项目的 owner 有权限对位置进行修改。项目 owner 主要有创建该项目的人、项目中的组长、创建分组的人、分组中的组长。</p>
<blockquote>
<p>Tips: owner 权限判断的优先级是 项目权限 &gt; 分组权限</p>
</blockquote>
<h2 id="项目拷贝">项目拷贝</h2>
<p>该功能在 v1.3.12 版本上线，项目克隆功能可复制项目全部接口到一个新项目，如下图所示,点击红色框里面的 icon 使用。</p>
<p>YApi 支持项目复制功能，但是无法复制项目中的测试集合 list。</p>
<p>操作： 点击下图左上角的复制按钮，在弹窗中写入复制项目名称点击确定就可以完成项目复制</p>
<img src="./images/usage/projectCopy.png">
<img src="./images/usage/project_copy_ok.png">
<blockquote>
<p>Tips: 如果你在该分组下有新建项目的权限，那你也同时拥有复制项目的权限</p>
</blockquote>
<h2 id="删除项目">删除项目</h2>
<p>点击下方的删除按钮，输入项目名称进行删除。</p>
<blockquote>
<p>删除项目是高风险操作，因此 YApi 对这个操作进行了特别的约束。</p>
</blockquote>
<h2 id="配置环境">配置环境</h2>
<p><code>环境配置</code> 一项可以添加该项目下接口的实际环境，供 <a href="./case.html">接口测试</a> 使用，这里增加了全局 header，可以在项目中设置全局 header 值。在接口运行页面的选择环境 select 中也增加<code>环境配置</code>弹层。</p>
<img src="./images/usage/project_setting_env.png">
<p>v1.3.21 新增全局变量，用户可以在环境列表中定义全局变量的名称和值, 接口运行或者测试集合里面可以通过 {{ global.err }} 来访问当前环境变量下定义的全局变量</p>
<img src="./images/usage/project_setting_global.png">
<p>新增Mysql、Redis、Es、firebase、General服务日志环境配置，项目使用时可根据不同环境的配置进行测试。mysql、redis、es在保存信息后续进行连接后才可正常使用。firebase使用时需先进行点击初始化才可正常使用，若在网页中出现firebase无法调用，需检查配置且重新初始化。General服务日志在保存信息后续进行连接后才可正常使用。</p>
<img src="./images/usage/project_setting_newOpt.png">
<h2 id="快捷操作-stripe支付、metamask连接">快捷操作 Stripe支付、Metamask连接</h2>
<p>若需调用第三方支付，可在头部点击图标。stripe支付为嵌入式页面，需公钥和认证token。metamask连接需安装插件，点击连接后调用请求配置函数ethsign进行eth登录</p>
<img src="./images/usage/headerOpts.png">
<h2 id="请求配置">请求配置</h2>
<p>pre-script, 通过自定义 js 脚本方式改变请求的参数和返回的 response 数据</p>
<h3 id="请求配置-全局公共方法">全局公共方法</h3>
<p>可在此处编辑一些公共的变量和函数以供后续脚本使用</p>
<pre><code>function generateSignature(){
    const PRIVASEA_SECRET = &#x27;V3X3nPmSfmFuZs1ByFn2Z7YcYtGyi0VfRZpmmraFPN5LRHPXeynghpEflBwsb0jv&#x27;;
    let bodyData = JSON.stringify(context.requestBody);
    let signpath = context.pathname.replace(&#x27;/deepsea-back&#x27;,&#x27;&#x27;);
    let signatureStr = context.method+signpath+&#x22;?&#x22;+bodyData;
    console.log(&#x27;signpath&#x27;,signpath);
    let signature = CryptoJS.HmacSHA256(signatureStr, PRIVASEA_SECRET).toString(CryptoJS.enc.Hex);
    console.log(signature);
    return signature;
}

var stakingAddress = &#x27;0xFA6E1d164ed6C1E7df35C6FEEAf620eE47D66B60&#x27;;
</code></pre>
<h3 id="请求配置-请求参数示例">请求参数示例</h3>
<p>以 jquery ajax 为例，假设当前的请求参数是</p>
<pre><code>{
  url: &#x27;/api/user?id=1&#x27;,
  method: &#x27;POST&#x27;,
  headers: {
    xxx: &#x27;xxx&#x27;
  },
  data: {
    type: 1
  }
}
</code></pre>
<p>那么公共变量 context 包含以下属性：</p>
<pre><code>context = {
  pathname: &#x27;/api/user&#x27;,
  query: {
    id: 1
  },
  requestHeader: {
    xxx: &#x27;xxx&#x27;
  },
  method: &#x27;POST&#x27;,
  requestBody: {
    type:1
  }
}
</code></pre>
<p>假设我们需要在一组接口的 url 上增加一个公共的 token 参数，可以写如下自定义脚本：</p>
<pre><code>context.query.token = context.utils.md5(context.pathname + &#x27;salt&#x27;);
</code></pre>
<h3 id="请求配置-返回数据示例">返回数据示例</h3>
<p>在上面的示例请求完成后，假设返回 responseData={a:1},公共变量 context 包含以下属性：</p>
<pre><code>context = {
  pathname: &#x27;/api/user&#x27;,
  query: {
    id: 1
  },
  requestHeader: {
    xxx: &#x27;xxx&#x27;
  },
  method: &#x27;POST&#x27;,
  requestBody: {
    type:1
  },
  responseData: {
    a:1
  },
  responseHeader: {
    content-type: &#x27;application/json&#x27;
    ...
  }
}
</code></pre>
<p>假设我们需要修改响应数据 responseData a 的值为 2，可以填写如下自定义脚本：</p>
<pre><code>context.responseData.a = 2;

</code></pre>
<blockquote>
<p>（v1.3.16+新增）context.href 和 context.hostname<br>
（v1.3.17+新增）context.caseId 测试用例的唯一 key 值<br>
（+新增）context.taskId 当前执行者id<br>
（+新增）context.ws 当前websock连接地址<br>
（+新增）context.wsmsg 传入域名，和查询条件可查询连接下的历史消息记录 let msgsall = context.wsmsg(uri,&quot;all&quot;)</p>
</blockquote>
<h3 id="请求配置-storage">storage</h3>
<p>storage.setItem 兼容浏览器和服务端，并且是持久化数据存储，不会丢失，用法类似于 localStorage。
storage 一共两个 api，分别是 setItem 和 getItem</p>
<pre><code class="language-js">storage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span> <span class="token string">'token-----xxxxx'</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>query<span class="token punctuation">.</span>token <span class="token operator">=</span> storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="请求配置-工具函数">工具函数</h3>
<pre><code>context.utils = {
  _         //underscore &#x51FD;&#x6570;,&#x8BE6;&#x7EC6; API &#x67E5;&#x770B;&#x5B98;&#x7F51; http://underscorejs.org/
  CryptoJS  // crypto-js&#xFF08;v1.3.21+&#x65B0;&#x589E;&#xFF09;, &#x8BE6;&#x7EC6;&#x7528;&#x6CD5;&#x770B; https://github.com/brix/crypto-js
  base64    //&#x8F6C;&#x6362;&#x5B57;&#x7B26;&#x4E32;&#x4E3A; base64 &#x7F16;&#x7801;
  md5       //&#x8F6C;&#x6362;&#x5B57;&#x7B26;&#x4E32;&#x4E3A; md5 &#x7F16;&#x7801;
  sha1      //&#x8F6C;&#x6362;&#x5B57;&#x7B26;&#x4E32;&#x4E3A; sha1 &#x7F16;&#x7801;
  sha224    //&#x8F6C;&#x6362;&#x5B57;&#x7B26;&#x4E32;&#x4E3A; sha224 &#x7F16;&#x7801;
  sha256    //&#x8F6C;&#x6362;&#x5B57;&#x7B26;&#x4E32;&#x4E3A; sha256 &#x7F16;&#x7801;
  sha384    //&#x8F6C;&#x6362;&#x5B57;&#x7B26;&#x4E32;&#x4E3A; sha384 &#x7F16;&#x7801;
  sha512    //&#x8F6C;&#x6362;&#x5B57;&#x7B26;&#x4E32;&#x4E3A; sha512 &#x7F16;&#x7801;
  unbase64  //&#x8F6C;&#x6362; base64 &#x7F16;&#x7801;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;  
  axios     // axios &#x5E93;&#xFF0C;&#x53EF;&#x7528;&#x4E8E; api &#x8BF7;&#x6C42;&#xFF0C;&#x5B98;&#x7F51; https://github.com/axios/axios
  firebasesgin  //&#x5728;&#x73AF;&#x5883;&#x4E2D;&#x5DF2;&#x521D;&#x59CB;&#x5316;firebase&#x540E;&#x5C31;&#x80FD;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#xFF0C;&#x6CE8;&#x610F;&#x662F;&#x5F02;&#x6B65;&#x7684; &#x9700;&#x8981;&#x8FDB;&#x884C;&#x5F02;&#x6B65;&#x7B49;&#x5F85; context.utils.firebasesgin();
  oauth2SignIn  //&#x4F7F;&#x7528;&#x8C37;&#x6B4C;oauth2&#x767B;&#x5F55;&#xFF0C;&#x53C2;&#x6570;&#x4E3A;client_id&#xFF0C;&#x6CE8;&#x610F;&#x914D;&#x7F6E;&#xFF1A;&#x27;redirect_uri&#x27;:window.location.origin+&#x27;/Oauth2&#x27;,&#x27;state&#x27;: &#x27;yapi&#x27;
  revokeAccess  //&#x8C37;&#x6B4C;&#x9000;&#x51FA;&#xFF0C;&#x53C2;&#x6570;&#x4E3A;&#x81EA;&#x5B9A;&#x4E49;token
  phone     //&#x751F;&#x6210;&#x968F;&#x673A;&#x624B;&#x673A;&#x53F7;
  idcard    //&#x751F;&#x6210;&#x968F;&#x673A;&#x8EAB;&#x4EFD;&#x8BC1;
  bancard   //&#x751F;&#x6210;&#x968F;&#x673A;&#x94F6;&#x884C;&#x5361;&#x53F7;&#xFF0C;&#x53EF;&#x4F20;&#x9996;&#x53F7;&#x6BB5;
  timestamp //&#x751F;&#x6210;&#x65F6;&#x95F4;&#x6233;&#xFF0C;&#x9ED8;&#x8BA4;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x6233;&#xFF0C;&#x53EF;&#x4F20;&#x67D0;&#x6BB5;&#x65F6;&#x95F4; 2024-09-03 16:53:13 
  timestampms   //&#x751F;&#x6210;&#x6BEB;&#x79D2;&#x7EA7;&#x65F6;&#x95F4;&#x6233;
  ethsign   //&#x8FDB;&#x884C;eth&#x767B;&#x5F55;&#xFF0C;&#x6CE8;&#x610F;&#x662F;&#x5F02;&#x6B65;&#x7B49;&#x5F85;&#x7684;&#xFF0C;&#x5FC5;&#x987B;&#x5148;&#x8FDE;&#x63A5;&#x94B1;&#x5305;
  encodeDES //DES&#x52A0;&#x5BC6; &#x4F20;&#x5165;&#x5BC6;&#x94A5;&#x548C;&#x5411;&#x91CF;
  encodeAES //AES&#x52A0;&#x5BC6;
  imgBase64 //&#x751F;&#x6210;&#x968F;&#x673A;&#x56FE;&#x7247;base64&#x5B57;&#x7B26;&#x4E32;
  tobedivisibleby //&#x6574;&#x9664;
  bs58Encode: utils.bs58Encode,
}
</code></pre>
<ul>
<li>firebasesgin、oauth2SignIn、revokeAccess、ethsign这些函数只能在前端测试时使用，服务端自动化测试不可调用，因为是基于浏览器的</li>
</ul>
<p>CryptoJS 具体用法</p>
<pre><code class="language-javascript"><span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Encrypt</span>
<span class="token keyword">var</span> ciphertext <span class="token operator">=</span> context<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'secret key 123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Decrypt</span>
<span class="token keyword">var</span> bytes <span class="token operator">=</span> context<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'secret key 123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> decryptedData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'decryptedData'</span><span class="token punctuation">,</span> decryptedData<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="请求配置-异步处理（v1.3.13+支持）">异步处理（v1.3.13+支持）</h3>
<p>处理请求参数，或返回数据，可能还会涉及到异步处理，比如 ajax 请求，YApi 在 v1.3.13 版本支持了异步处理。</p>
<pre><code class="language-javascript">context<span class="token punctuation">.</span>promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> api <span class="token operator">=</span> context<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://yapi.local.qunar.com:3000/api/user/status'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  api<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//...</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>promise 还可以来设置接口延迟</p>
<pre><code class="language-javascript">context<span class="token punctuation">.</span>promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'delay 1000ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>使用方法就是在 <code>context</code> 里面添加 <code>promise</code> 参数,并且返回一个 Promise，不熟悉 Promise 的童鞋可以查下相关用法，ajax 请求可以使用 <code>context.utils.axios</code> 库。</p>
<blockquote>
<p>处理完成后，不要忘记 <code>resolve()</code>，不然会一直处于挂起状态</p>
</blockquote>
<p>timeoutLimit 可以在请求前设置timeoutLimit的ms时间，用于判断接口超时处理，优先级用例&gt;集合&gt;工程。若超时那么会报错状态码408</p>
<pre><code class="language-javascript"><span class="token keyword">var</span> timeoutLimit <span class="token operator">=</span> <span class="token string">'6000'</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="token">token</h2>
<p>每个项目都有唯一的标识 token，用户可以使用这个 token 值来请求 openapi。</p>
<p><a href="https://hellosean1025.github.io/yapi/openapi.html" target="_blank">openapi 文档地址</a></p>
<h2 id="全局mock">全局mock</h2>
<p>v1.3.21 新增全局 mock 设置，方便用户在项目层面上全局设置公共的mock数据，具体 mock 脚本详细使用方法详见 <a href="./adv_mock.html#自定义-mock-脚本">自定义 Mock 脚本</a></p>
<p>可以针对项目自定义 Mock 占位符，具体使用方法如下：</p>
<pre><code>Random.extend({
    constellation: function(date) {
        var constellations = [&#x27;&#x767D;&#x7F8A;&#x5EA7;&#x27;, &#x27;&#x91D1;&#x725B;&#x5EA7;&#x27;, &#x27;&#x53CC;&#x5B50;&#x5EA7;&#x27;, &#x27;&#x5DE8;&#x87F9;&#x5EA7;&#x27;, &#x27;&#x72EE;&#x5B50;&#x5EA7;&#x27;, &#x27;&#x5904;&#x5973;&#x5EA7;&#x27;, &#x27;&#x5929;&#x79E4;&#x5EA7;&#x27;, &#x27;&#x5929;&#x874E;&#x5EA7;&#x27;, &#x27;&#x5C04;&#x624B;&#x5EA7;&#x27;, &#x27;&#x6469;&#x7FAF;&#x5EA7;&#x27;, &#x27;&#x6C34;&#x74F6;&#x5EA7;&#x27;, &#x27;&#x53CC;&#x9C7C;&#x5EA7;&#x27;]
        return this.pick(constellations)
    }
})

</code></pre>
<p>在接口编辑中使用</p>
<pre><code>{
  &#x22;data&#x22;: &#x22;@CONSTELLATION&#x22;   // =&#x3E; &#x22;&#x6C34;&#x74F6;&#x5EA7;&#x22;
}
</code></pre>
<h3 id="全局mock-mock-优先级说明">Mock 优先级说明</h3>
<p>请求 Mock 数据时，规则匹配优先级：Mock 期望 &gt; 自定义 Mock 脚本 &gt; 项目全局 mock 脚本 &gt; 普通 Mock。</p>
<p>如果前面匹配到 Mock 数据，后面 Mock 则不返回。</p>
<h2 id="飞书机器人通知">飞书机器人通知</h2>
<p>添加飞书机器人webhook地址，选择需要通知的类型，并打开。在此项目中，相应类型操作后进行飞书机器人推送</p>
<img src="./images/usage/Feishu robot.png">
</div><div class="m-content-container m-paging"><div class="m-paging-prev m-paging-item"><a href="manage.html" class="href"><span class="ui-font-ydoc"></span>权限</a></div><div class="m-paging-next m-paging-item"><a href="api.html" class="href">接口操作<span class="ui-font-ydoc"></span></a></div></div></div></div></div><div><div class="m-mask js-mask">
    <div class="container">
      <img src="" alt="" class="img js-mask-img" />
    </div>
    </div></div><script>
    var $content = document.getElementById('js-content');
    var $summaryItems = Array.prototype.slice.call(document.querySelectorAll('#js-menu .href'));
    var $menu = document.getElementById('js-menu');
    if (sessionStorage.prevPathname) {
      sessionStorage.setItem('prevPrevPathname', sessionStorage.prevPathname);
      sessionStorage.setItem('prevPrevMenuScrollTop', sessionStorage.prevMenuScrollTop);
      sessionStorage.setItem('prevPrevContentScrollTop', sessionStorage.prevContentScrollTop);
    }
    if (sessionStorage.locationPathname) {
      sessionStorage.setItem('prevPathname', sessionStorage.locationPathname);
      sessionStorage.setItem('prevMenuScrollTop', sessionStorage.menuScrollTop);
      sessionStorage.setItem('prevContentScrollTop', sessionStorage.contentScrollTop);
    }
    if ($menu && sessionStorage.menuScrollTop) {
		  $menu.scrollTop = sessionStorage.menuScrollTop;
    }
    // 刷新页面但不切换 pathname 的时候，内容区恢复到记忆的高度
    if ($content && sessionStorage.contentScrollTop && window.location.pathname == sessionStorage.locationPathname) {
      $content.scrollTop = sessionStorage.contentScrollTop;
    } else if (sessionStorage.prevPrevPathname && sessionStorage.prevPrevPathname === window.location.pathname) {
      if ($menu && sessionStorage.prevPrevMenuScrollTop) {
        $menu.scrollTop = sessionStorage.prevPrevMenuScrollTop;
      }
      if ($content && sessionStorage.prevPrevContentScrollTop) {
        $content.scrollTop = sessionStorage.prevPrevContentScrollTop;
      }
    }
    sessionStorage.setItem('locationPathname', window.location.pathname);
    </script><script src="..\ydoc\scripts\plugins\dollar.min.js"></script><script src="..\ydoc\scripts\plugins\responsive-nav.min.js"></script><script src="..\ydoc\scripts\plugins\slideout.min.js"></script><script src="..\ydoc\scripts\app.js"></script><script src="..\ydoc\ydoc-plugin-search\core.js"></script><script src="..\ydoc\ydoc-plugin-search\search.js"></script><script src="..\ydoc\ydoc-plugin-search\core.js"></script><script src="..\ydoc\ydoc-plugin-search\search.js"></script><script src="..\ydoc\ydoc-plugin-img-view\imgView.js"></script><script src="..\search_json.js"></script><script src="..\search_json.js"></script></body></html>